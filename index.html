<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>QR Code Redirect</title>

  <script src="urls.js"></script>

  <script>
    async function doRedirect() {
      // Pick random URL
      if (!Array.isArray(urls) || urls.length === 0) {
        console.error("No URLs found.");
        return;
      }
      const randomURL = urls[Math.floor(Math.random() * urls.length)];

      // Get ?src= or use "Unknown"
      const params = new URLSearchParams(window.location.search);
      const src = params.get("src") || "Unknown";

      // Send to JSONBin (optional if it fails)
      try {
        await fetch("https://api.jsonbin.io/v3/b", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "X-ACCESS-KEY": "YOUR_ACCESS_KEY_HERE"
          },
          body: JSON.stringify({
            src: src,
            target: randomURL,
            ts: Date.now()
          })
        });
      } catch (e) {
        console.error("JSONBin error:", e);
      }

      // Redirect user
      window.location.href = randomURL;
    }

    // Automatically run on page load
    window.addEventListener("load", () => {
      setTimeout(doRedirect, 100);
    });
  </script>

</head>
<body style="font-family: sans-serif;">

  <p style="text-align: center; margin-top: 40px; font-size: 18px;">
    If you don't get redirected, tap:<br><br>
    <button 
      onclick="doRedirect()"
      style="padding: 12px 20px; font-size: 18px; border-radius: 8px; cursor: pointer;"
    >
      HERE
    </button>
  </p>

</body>
</html>
